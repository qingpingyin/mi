(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-547595ea"],{"2bd3":function(e,t,r){"use strict";var s=r("5833"),i=r.n(s);i.a},5833:function(e,t,r){},bfd7:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"order-comfirm"},[r("order-header",{attrs:{title:"确认订单"}}),r("div",{staticClass:"order-info-area"},[r("div",{staticClass:"container"},[e.addressList.length>0||this.$store.getters.cart.checkGoods.length>0?r("div",{staticClass:"order-section"},[r("div",{staticClass:"order-content"},[r("section",{staticClass:"address-wrapper"},[r("h3",[e._v("收货地址")]),r("div",{staticClass:"address"},[e._l(e.addressList,(function(t,s){return r("div",{key:s,staticClass:"addr-box user-address",class:{selected:e.isSelected===s+1},on:{click:function(r){return e.chooseAddress(t,s)}}},[r("h4",{staticClass:"consignee"},[e._v(e._s(t.receiver_name))]),r("p",{staticClass:"phone"},[e._v(e._s(t.receiver_mobile))]),r("p",[e._v(e._s(t.receiver_province)+" "+e._s(t.receiver_city)+" "+e._s(t.receiver_district))]),r("p",[e._v(e._s(t.receiver_address))]),e.isSelected===s+1?r("p",{staticClass:"footer"},[r("span",{staticClass:"iconfont icon-delete",on:{click:function(t){e.delModalShow=!0}}}),r("span",{staticClass:"btn-modify",on:{click:function(r){return e.modifyAddress(t)}}},[e._v("修改")])]):e._e()])})),r("div",{staticClass:"addr-box add-address",on:{click:function(t){e.modalShow=!0}}},[r("span",{staticClass:"icon-plus"},[e._v("+")]),r("span",{staticClass:"text"},[e._v("添加新地址")])])],2)]),r("section",{staticClass:"product-wrapper"},[r("h3",[e._v("商品及优惠券")]),r("ul",{staticClass:"product-list"},e._l(e.cart.checkGoods,(function(t,s){return r("li",{key:s,staticClass:"product-item"},[r("div",{staticClass:"col col-img"},[r("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.product.img_url,expression:"item.product.img_url"}],attrs:{alt:""}})]),r("div",{staticClass:"col col-name"},[r("a",{attrs:{href:""}},[e._v(e._s(t.product.title))])]),r("div",{staticClass:"col col-price"},[e._v(e._s(t.num)+" x "+e._s(t.product.shop_price))]),r("div",{staticClass:"col col-total"},[e._v(e._s(t.num*t.product.shop_price)+"元")])])})),0)]),e._m(0),r("section",{staticClass:"order-views-wrapper"},[r("div",{staticClass:"left"}),r("div",{staticClass:"right"},[e._m(1),r("ul",{staticClass:"nums-list"},[r("li",[e._v(e._s(e.cart.checkGoods.length)+"件")]),r("li",[e._v(e._s(e.totalPrice)+"元")]),r("li",[e._v("-0元")]),r("li",[e._v("-0元")]),r("li",[e._v("0元")]),r("li",[r("span",{staticClass:"total-price"},[e._v(e._s(e.totalPrice))]),e._v(" 元 ")])])])])]),0!==e.isSelected&&0!==this.$store.getters.cart.checkGoods.length?r("div",{staticClass:"order-footer"},[r("div",{staticClass:"reveiver-address"},[r("p",{directives:[{name:"show",rawName:"v-show",value:e.isSelected,expression:"isSelected"}]},[e._v(e._s(e.userInfo))]),r("p",{directives:[{name:"show",rawName:"v-show",value:e.isSelected,expression:"isSelected"}]},[e._v(" "+e._s(e.address)+" ")])]),r("div",{staticClass:"btn-group"},[r("span",{staticClass:"btn btn-back",on:{click:function(t){return e.$router.push({name:"cart"})}}},[e._v("返回购物车")]),r("span",{staticClass:"btn btn-pay",on:{click:e.toOrder}},[e._v("去下单")])])]):e._e()]):e._e(),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showLoading,expression:"showLoading"}],staticClass:"spinner"},[r("div",{staticClass:"rect1"}),r("div",{staticClass:"rect2"}),r("div",{staticClass:"rect3"}),r("div",{staticClass:"rect4"}),r("div",{staticClass:"rect5"})])])]),r("Modal",{attrs:{modalShow:e.modalShow,title:"收货地址"},on:{close:function(t){e.modalShow=!1},cancle:function(t){e.modalShow=!1},confirm:e.addNewAddress},scopedSlots:e._u([{key:"dialog-body",fn:function(){return[r("form",{staticClass:"new-address"},[r("div",{staticClass:"input-group"},[r("div",{staticClass:"input-item",class:{"input-focus":1==e.target,"input-active":""!=e.newAddress.receiver_name}},[r("label",{attrs:{for:"name"}},[e._v("姓名")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newAddress.receiver_name,expression:"newAddress.receiver_name"}],attrs:{type:"text",placeholder:1==e.target?"收货人姓名":"",id:"name"},domProps:{value:e.newAddress.receiver_name},on:{focus:function(t){e.target=1},blur:function(t){e.target=0},input:function(t){t.target.composing||e.$set(e.newAddress,"receiver_name",t.target.value)}}})]),r("div",{staticClass:"input-item",class:{"input-focus":2==e.target,"input-active":""!=e.newAddress.receiver_mobile}},[r("label",{attrs:{for:"phone"}},[e._v("手机号")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newAddress.receiver_mobile,expression:"newAddress.receiver_mobile"}],attrs:{type:"text",placeholder:2==e.target?"手机号":"",id:"phone"},domProps:{value:e.newAddress.receiver_mobile},on:{focus:function(t){e.target=2},blur:function(t){e.target=0},input:function(t){t.target.composing||e.$set(e.newAddress,"receiver_mobile",t.target.value)}}})])]),r("div",{staticClass:"aj-china-area"},[r("span",[e._v("省:")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.newAddress.receiver_province,expression:"newAddress.receiver_province"}],staticClass:"aj-select",on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.newAddress,"receiver_province",t.target.multiple?r:r[0])},function(t){return e.changeCity()}]}},[r("option",{attrs:{value:""}},[e._v("请选择")]),e._l(e.optionData,(function(t,s){return r("option",{key:s,domProps:{value:t.name}},[e._v(e._s(t.name))])}))],2),r("span",[e._v("市: ")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.newAddress.receiver_city,expression:"newAddress.receiver_city"}],staticClass:"aj-select",on:{change:[function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.newAddress,"receiver_city",t.target.multiple?r:r[0])},function(t){return e.changeDistrict()}]}},e._l(e.cityArr,(function(t,s){return r("option",{key:s,domProps:{value:t.name}},[e._v(e._s(t.name))])})),0),r("span",[e._v("区:")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.newAddress.receiver_district,expression:"newAddress.receiver_district"}],staticClass:"aj-select",on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.newAddress,"receiver_district",t.target.multiple?r:r[0])}}},e._l(e.districtArr,(function(t,s){return r("option",{key:s,domProps:{value:t.name}},[e._v(e._s(t.name))])})),0)]),r("div",{staticClass:"input-group textarea-wrapper"},[r("div",{staticClass:"input-item",class:{"input-focus":3==e.target,"input-active":""!=e.newAddress.receiver_address}},[r("label",{attrs:{for:"address-name"}},[e._v("详细地址")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newAddress.receiver_address,expression:"newAddress.receiver_address"}],attrs:{placeholder:3==e.target?"详细地址，路名或街道名称，门牌号":"",id:"address-name"},domProps:{value:e.newAddress.receiver_address},on:{focus:function(t){e.target=3},blur:function(t){e.target=0},input:function(t){t.target.composing||e.$set(e.newAddress,"receiver_address",t.target.value)}}})])])])]},proxy:!0}])}),r("Modal",{attrs:{modalShow:e.delModalShow,title:"删除收货地址",msg:"确定要删除这个地址吗？"},on:{close:function(t){e.delModalShow=!1},cancle:function(t){e.delModalShow=!1},confirm:e.delAddress}})],1)},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"dilivery-ways"},[r("h3",[e._v("配送方式")]),r("span",{staticClass:"ways"},[e._v("包邮")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ul",{staticClass:"title-list"},[r("li",[e._v("商品件数:")]),r("li",[e._v("商品总价:")]),r("li",[e._v("活动优惠:")]),r("li",[e._v("优惠券抵扣:")]),r("li",[e._v("运费:")]),r("li",{staticClass:"total-price-title"},[e._v("应付总额:")])])}],a=r("1da1"),n=r("5530"),c=(r("96cf"),r("99af"),r("159b"),r("b0c0"),r("4c53"),r("c3d4")),o=r("714b"),d=r("2f62"),l=r("2f94"),u=r("2e8e"),v=r("f8b7"),p={name:"confirm-order",data:function(){return{optionData:u["a"],cityArr:[],districtArr:[],showLoading:!0,delModalShow:!1,modalShow:!1,target:0,addressList:[],isSelected:0,addressId:null,selectedAddress:{},newAddress:{receiver_name:"",receiver_mobile:"",receiver_province:"",receiver_city:"",receiver_district:"",receiver_address:""}}},computed:Object(n["a"])(Object(n["a"])({},Object(d["b"])(["cart"])),{},{address:function(){var e=this.selectedAddress,t=e.receiver_province,r=e.receiver_city,s=e.receiver_district,i=e.receiver_address;return"".concat(t," ").concat(r," ").concat(s," ").concat(i)},userInfo:function(){var e=this.selectedAddress,t=e.receiver_name,r=e.receiver_mobile;return"".concat(t," ").concat(r)},totalPrice:function(){for(var e=0,t=0;t<this.$store.getters.cart.checkGoods.length;t++){var r=this.$store.getters.cart.checkGoods[t];e+=r.num*r.product.shop_price}return e}}),methods:{addNewAddress:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["a"])(e.newAddress);case 2:r=t.sent,200==r.status&&(e.modalShow=!1,e.initAddress());case 4:case"end":return t.stop()}}),t)})))()},changeCity:function(){var e=this,t="";e.optionData.forEach((function(r){r.name===e.newAddress.receiver_province&&(t=r)})),this.cityArr=t.sub,this.newAddress.receiver_city=t.sub[0].name},changeDistrict:function(){var e=this,t="";e.cityArr.forEach((function(r){r.name===e.newAddress.receiver_city&&(t=r)})),this.districtArr=t.sub,this.newAddress.receiver_district=t.sub[0].name},toOrder:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$store.getters.cart.checkGoods,s=[],r.forEach((function(e){s.push(e.product.id)})),t.next=5,Object(v["a"])({uid:e.$store.getters.user.id,address_id:e.addressId,pids:s}).then((function(t){console.log(t.data),e.$store.dispatch("cart/getCartList"),e.$router.push({name:"orderSuccess",query:{aid:t.data.aid,oid:t.data.id}})}));case 5:case"end":return t.stop()}}),t)})))()},delAddress:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["b"])(e.addressId).then((function(){e.delModalShow=!1,e.initAddress()}));case 2:case"end":return t.stop()}}),t)})))()},modifyAddress:function(e){this.modalShow=!0,this.newAddress=e},chooseAddress:function(e,t){this.isSelected=t+1,this.selectedAddress=e,this.addressId=e.id},initAddress:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["c"])({uid:e.$store.getters.user.id}).then((function(t){e.showLoading=!1,e.addressList=t.data}));case 2:case"end":return t.stop()}}),t)})))()}},components:{OrderHeader:c["a"],Modal:o["a"]},mounted:function(){this.initAddress()}},m=p,_=(r("2bd3"),r("2877")),f=Object(_["a"])(m,s,i,!1,null,null,null);t["default"]=f.exports},f8b7:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return a})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return c}));var s=r("b775");function i(e){return Object(s["a"])({url:"/createOrder",method:"post",data:e})}function a(e){return Object(s["a"])({url:"/order",method:"get",params:e})}function n(e){return Object(s["a"])({url:"/orderById",method:"get",params:e})}function c(e){return Object(s["a"])({url:"/getOrderCount",method:"get",params:e})}}}]);